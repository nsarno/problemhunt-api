"use strict";angular.module("problemhunt",["ngTouch","ngCookies","restangular","ui.router","angulartics","angulartics.google.analytics","pascalprecht.translate"]).constant("ACCESS_LEVELS",{pub:1,user:2}).constant("BASE_URL","https://problemhunt.herokuapp.com").config(["$urlRouterProvider","$locationProvider","RestangularProvider","BASE_URL",function(t,o,n,e){t.otherwise("/login"),n.setBaseUrl(e),n.addResponseInterceptor(function(t,o,n){return"getList"===o?(console.log("GETLIST"),t[n]):t})}]),angular.module("problemhunt").config(["$translateProvider",function(t){t.translations("en",{}),t.preferredLanguage("en")}]),angular.module("problemhunt").factory("AuthInterceptor",["$rootScope","$q","$cookieStore","$injector","BASE_URL",function(t,o,n,e,r){return{request:function(t){return t.headers=t.headers||{},n.get("token")&&(t.headers.Authorization="Bearer "+n.get("token")),t},response:function(t){e.get("$state");return t||o.when(t)},responseError:function(n){switch(n.status){case 401:console.log(n.config.url),n.config.url!==r+"/auth"&&t.$broadcast("auth:loginRequired");break;case 403:t.$broadcast("auth:forbidden");break;case 404:t.$broadcast("auth:notFound");break;case 500:t.$broadcast("server:error")}return o.reject(n)}}}]),angular.module("problemhunt").config(["$httpProvider",function(t){t.interceptors.push("AuthInterceptor")}]),angular.module("problemhunt").factory("Auth",["Restangular","$cookieStore","ACCESS_LEVELS",function(t,o,n){var e=o.get("token"),r=o.get("user"),a=function(t){e=t,o.put("token",e)},s=function(t){r=t,o.put("user",r)};return{isAuthorized:function(t){return t===n.pub||!!e},login:function(o,n){t.all("auth").post({user:o}).then(function(o){a(o.token),t.one("users",o.user_id).get().then(function(t){s(t.user),n()})})},setToken:a,token:function(){return e},setUser:s,user:function(){return t.one("users",r.id).get()},logout:function(){e=null,r=null,o.remove("token"),o.remove("user")},isAuthenticated:function(){return!!e}}}]).run(["$rootScope","$state","Auth",function(t,o,n){t.$on("$stateChangeStart",function(t,e){n.isAuthorized(e.access_level)||(t.preventDefault(),o.go("login")),"login"===e.name&&n.isAuthenticated()&&(t.preventDefault(),o.go("cards"))})}]),angular.module("problemhunt").factory("Problem",["Auth","Restangular","$state",function(t,o,n){var e=[];return{setupCards:function(o){t.user().then(function(t){e=_.clone(t.user.organization.problems),o()})},next:function(){for(var t,o=!1;!o;){if(console.log("stack len",e.length),0===e.length)return n.go("contribute"),void 0;t=e.pop(),console.log(t.upvoted),0==t.upvoted&&(o=!0)}return t},upvote:function(n){o.all("upvotes").post({problem_id:n.id,user_id:t.user().id})},submit:function(t){o.all("problems").post({problem:t}).then(function(t){console.log(t)})},tops:function(o){t.user().then(function(t){o(_.sortBy(t.user.organization.problems,function(t){return-t.upvote_count}).slice(0,15))})}}}]),angular.module("problemhunt").config(["$stateProvider","ACCESS_LEVELS",function(t,o){t.state("login",{url:"/login",templateUrl:"partials/login.html",controller:"LoginController",access_level:o.pub})}]).controller("LoginController",["$scope","$rootScope","$state","Auth",function(t,o,n,e){t.login=function(r){e.login(r,function(){o.user={email:t.user.email},n.go("cards")})}}]),angular.module("problemhunt").config(["$stateProvider","ACCESS_LEVELS",function(t,o){t.state("cards",{url:"/cards",templateUrl:"partials/card.html",controller:"CardController",access_level:o.user})}]).controller("CardController",["$scope","Problem","Auth",function(t,o,n){n.user().then(function(o){t.organization=o.user.organization}),o.setupCards(function(){t.current_problem=o.next()}),t.upvote=function(n){o.upvote(n),t.current_problem=o.next()},t.ignore=function(){t.current_problem=o.next()}}]),angular.module("problemhunt").config(["$stateProvider","ACCESS_LEVELS",function(t,o){t.state("contribute",{url:"/contribute",templateUrl:"partials/submit.html",controller:"SubmitController",access_level:o.user})}]).controller("SubmitController",["$scope","$state","Auth","Problem",function(t,o,n,e){n.user().then(function(o){t.organization=o.user.organization}),t.submit=function(t){e.submit(t),o.go("results")},t.ignore=function(){o.go("results")}}]),angular.module("problemhunt").config(["$stateProvider","ACCESS_LEVELS",function(t,o){t.state("results",{url:"/results",templateUrl:"partials/results.html",controller:"ResultsController",access_levels:o.user})}]).controller("ResultsController",["$scope","Auth","Problem",function(t,o,n){o.user().then(function(o){t.organization=o.user.organization}),n.tops(function(o){t.tops=o}),t.logout=function(){o.logout()}}]),function(t){try{t=angular.module("problemhunt")}catch(o){t=angular.module("problemhunt",[])}t.run(["$templateCache",function(t){t.put("partials/card.html",'<div class="container"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="navbar-header"><span class="navbar-brand">Problem Hunt @{{ organization.name }}</span></div></nav><div class="row"><div class="col-xs-1"></div><div class="col-xs-10 mt-1"><div class="panel panel-default"><div class="panel-body"><div class="row"><div class=""><p class="text-justify ph-1">{{ current_problem.description }}</p></div></div><div class="row"><div class="col-xs-6"><button ng-click="upvote(current_problem)" class="btn btn-success btn-block">Definitely</button></div><div class="col-xs-6"><button ng-click="ignore()" class="btn btn-danger btn-block">Meh</button></div></div></div></div></div><div class="col-xs-1"></div></div></div>')}])}(),function(t){try{t=angular.module("problemhunt")}catch(o){t=angular.module("problemhunt",[])}t.run(["$templateCache",function(t){t.put("partials/dashboard.html",'<div id="dashboard"><nav class="navbar navbar-static-top" role="navigation"><div class="container-fluid"><div class="navbar-header"><div class="navbar-brand"><strong>problemhunt</strong></div></div><div class="collapse navbar-collapse"><button ng-click="logout()" type="button" class="btn btn-default navbar-btn pull-right">sign out</button></div></div></nav><div class="container"><h1>Hunt problems @{{ organization.name }}</h1><ul ng-repeat="problem in organization.problems"><li>{{ problem.description }} ({{ problem.upvote_count }})</li><button ng-show="!problem.upvoted" ng-click="upvote(problem)" class="btn btn-primary">Upvote</button> <button ng-show="problem.upvoted" ng-click="downvote(problem)" class="btn btn-primary">Upvoted</button></ul><div class="col col-lg-6" <="" div=""><h3>You\'re problem is not in the list? Let us know...</h3><form ng-submit="submitProblem(problem)"><div class="form-group"><input class="form-control" ng-model="problem.description" type="text" name="problem" placeholder="My problem is ..."></div><div class="form-group"><button class="form-control" type="submit">Hunt it down</button></div></form></div></div></div>')}])}(),function(t){try{t=angular.module("problemhunt")}catch(o){t=angular.module("problemhunt",[])}t.run(["$templateCache",function(t){t.put("partials/login.html",'<div class="container"><div class="row"><div class="col-xs-4"></div><div class="col-xs-4"><img class="img-responsive mt-1" src="images/logo.png"></div><div class="col-xs-4"></div></div><div class="row"><div class="col-xs-1"></div><div class="col-xs-10 mt-1"><div class="panel panel-default"><div class="panel-body"><p class="text-uppercase text-center">We are an independant organization and will never disclose your private information. <strong>To submit your problems idea about startupbus just input your email as follow "your_name@startubus.com" and the password you want, then just click connect.</strong></p></div></div><form ng-submit="login(user)" role="form"><div class="form-group"><input class="form-control" ng-model="user.email" type="text" name="user" placeholder="Username"></div><div class="form-group"><input class="form-control" ng-model="user.password" type="password" name="password" placeholder="Password"></div><div class="form-group"><input class="form-control btn btn-primary" type="submit" value="Connect"></div></form></div></div></div>')}])}(),function(t){try{t=angular.module("problemhunt")}catch(o){t=angular.module("problemhunt",[])}t.run(["$templateCache",function(t){t.put("partials/results.html",'<!DOCTYPE html><div class="container"><nav class="navbar navbar-default navbar-fixed-top" role="navigation"><div class="navbar-header"><span class="navbar-brand">Problem Hunt @{{ organization.name }}</span></div></nav><div ng-repeat="top in tops" class="row"><div class="col-xs-1"></div><div class="col-xs-10"><div class="panel panel-default"><div class="panel-heading"><h2 class="panel-title"><small><i class="glyphicon glyphicon-user"></i> {{ top.upvote_count }} upvoted this</small></h2></div><div class="panel-body"><div class="row"><div class=""><p class="text-justify ph-1">{{ top.description }}</p></div></div></div></div></div><div class="col-xs-1"></div></div><nav ui-sref="cards" class="navbar navbar-default navbar-green navbar-fixed-bottom" role="navigation"><div class="container"><p class="navbar-text text-center text-white"><strong>Contribute</strong></p></div></nav></div>')}])}(),function(t){try{t=angular.module("problemhunt")}catch(o){t=angular.module("problemhunt",[])}t.run(["$templateCache",function(t){t.put("partials/submit.html",'<div class="container"><div class="row"><div class="col-xs-4"></div><div class="col-xs-4"><img class="img-responsive mt-1" src="images/logo.png"></div><div class="col-xs-4"></div></div><div class="row"><div class="col-xs-12 mt-1"><form ng-submit="submit(problem)" role="form"><div class="form-group"><label>Something about @{{organization.name}} is bothering you? Be awesome and tell us about it!</label> <input ng-model="problem.description" class="form-control" rows="5"></div><div class="form-group"><button type="submit" class="btn btn-block btn-primary">Am I the only one?</button></div><div class="form-group"><button ng-click="ignore()" class="btn btn-block btn-default">Skip to results</button></div></form></div></div></div>')}])}();